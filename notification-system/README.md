# 📩 Notification System (LLD in Java)

## 🧾 Problem Statement

Design a system that sends notifications to users via multiple channels (Email, SMS, Push), respecting user preferences and handling failures via retry mechanisms.

## 🧾 Introduction

This is a production-grade **Notification System** implemented in Java using **Low-Level Design (LLD) principles** and enhanced with **OpenAI's GPT-3.5-turbo** for intelligent message generation.

No static templates are used — messages are dynamically generated by GPT at runtime, making this a modern, extensible backend system perfect for real-world applications and product-based interviews.


---

## ❓ Clarifying Questions

| Question | Why It's Important |
|----------|--------------------|
| What types of channels to support? | Impacts which strategies we implement |
| Should we support user preferences? | Decides if fallback is needed |
| Is retry required on failure? | Affects robustness and delivery guarantees |

---

A modular, extensible notification system built using clean code principles and design patterns in Java.

## ✅ Features
- Supports Email, SMS, and Push notifications
- Pluggable Retry Strategy (in-memory now, Kafka-ready later)
- 🧠 **GenAI Integration** with OpenAI (`gpt-3.5-turbo`)
- User-specific channel preferences
- Strategy Pattern for pluggable channels
- Graceful fallback on failure
- Easily extendable (e.g., WhatsApp, Retry queue)
- Easily swap retry mechanism (e.g., Kafka, DB, Scheduler)

## 🧠 GenAI-Powered Message Generator

This project uses **OpenAI's `/v1/chat/completions`** endpoint via OkHttp and Gson.

```java
OpenAIClient client = new OpenAIClient(System.getenv("OPENAI_API_KEY"));
String message = client.generateMessage("Write a short shipping update for Shubham");

The new `service.message` package includes:

| Class | Description |
|-------|-------------|
| `OpenAIClient` | Calls OpenAI API to generate smart messages |
| `MessageContentGenerator` | Strategy interface for message creation |
| `OpenAIBasedMessageGenerator` | GPT-backed implementation |

The OpenAIBasedMessageGenerator is plugged into the main flow, replacing any hardcoded messages.

---

## 🧪 Example Output

> “Hi Shubham! Your order #123456 has been shipped and is on its way. 🚚📦”


## 🧠 Pluggable Retry Strategy

The system uses a `RetryHandler` interface. You can swap retry logic easily:

```java
RetryHandler retryHandler = new InMemoryRetryHandler(3);
// OR in future:
// RetryHandler retryHandler = new KafkaRetryHandler();

## This makes it future-proof for:
- Kafka or SQS-based async retry
- Cron-based batch retry
- Circuit breaker integration

## 🧱 Class Design Highlights
- Follows SOLID principles
- Interface segregation via `NotificationChannel`
- Strategy Pattern for dynamic channel invocation
- Clean separation of model, channel, and service layers

📐 Extensibility Ideas
- Add Kafka-based retry queue
- Store user preferences in Redis or DB
- Track notification status in metrics system

## 🧱 Class Design

- `Notification`
- `UserPreference`
- `NotificationChannel` (interface)
- `EmailChannel`, `SMSChannel`, `PushChannel`
- `NotificationService`
- `RetryPolicy`

**Design Patterns Used:** Strategy Pattern, SRP(Single Responsibility Principal)

---

🔧 Setup Instructions

1. Clone the Repository
git clone https://github.com/sk444/lld-system-designs-java.git
cd lld-system-designs-java/notification-system

2. Add JAR Dependencies (into lib/ folder)

| JAR                 | Purpose                |
| ------------------- | ---------------------- |
| `okhttp-4.10.0.jar` | HTTP client for OpenAI |
| `gson-2.10.1.jar`   | JSON parsing           |
| `okio-2.10.0.jar`   | Dependency of OkHttp   |

✅ You must also add these JARs to your IntelliJ module dependencies.

3. Set Your OpenAI API Key
In IntelliJ:
   Go to Run > Edit Configurations
   Add an Environment Variable:

OPENAI_API_KEY= xxxxxxxxxxxxxxxxxxxx

⚠️ Make sure billing is enabled on your OpenAI account, or this will return 429 or 404. And please don't share your Open API Key publicly.

4. Run the App
Open Main.java and run it. You should see a friendly message like:

📌 How It Works

[Main.java]
     ↓
[NotificationService]
     ↓
[OpenAIBasedMessageGenerator] → Calls OpenAI → GPT-generated message
     ↓
[Email/SMS/Push Channel]
     ↓
[RetryHandler] (if delivery fails)

📊 LLD Principles Used
- Strategy Pattern – for retry logic and message generation
- Open/Closed Principle – new channels or message generators can be added without modifying existing code
- Interface Segregation – all services exposed via interfaces
- Single Responsibility – message, retry, and delivery are separate

💡 Future Improvements
- Add Kafka-based retry queue
- Support for message tone variation (casual/formal)
- Add analytics/logging on delivery success
- Language translation using GPT for multilingual notifications

👨‍💻 Author
Shubham Kumar
🔗 LinkedIn
🔧 GitHub





